# 农业物联网可视化系统 v2.0
## Go Gin + Streamlit 现代化重构版

基于现代化技术栈的农业物联网数据可视化平台，支持实时数据监控、Fork项目管理、智能分析等功能。

## 🚀 系统特色

### 🔄 Git-like Fork功能
- **项目配置Fork**: 用户可以Fork他人的可视化配置
- **版本控制**: 完整的配置变更历史追踪
- **协作共享**: 支持项目点赞、分享和合并请求
- **权限管理**: 灵活的公开/私有项目控制

### 📊 现代化数据可视化
- **实时数据流**: WebSocket实时数据推送
- **交互式图表**: 基于Plotly的专业图表组件
- **响应式设计**: 完美的PC和移动端体验
- **智能缓存**: Redis多层缓存优化性能

### 🌐 IoT设备全面支持
支持13种农业物联网设备类型：
- 🌤️ 气象站 
- 🌱 土壤墒情
- 💧 水质监测
- 📹 视频监控
- ⚡ 配电柜
- 🐛 虫情监测
- 🦠 孢子仪
- 🌡️ 环境监测
- 💦 智能灌溉
- 💡 杀虫灯
- 🚪 一体化闸门
- 🌊 积水传感器
- 📊 植物生长记录仪

## 🏗️ 技术架构

### 后端技术栈
- **Go Gin**: 高性能Web框架
- **PostgreSQL**: 主数据库
- **Redis**: 缓存和消息队列
- **WebSocket**: 实时数据推送
- **JWT**: 安全认证

### 前端技术栈
- **Streamlit**: Python Web框架
- **Plotly**: 交互式数据可视化
- **Folium**: 地图可视化
- **WebSocket Client**: 实时数据接收

### 部署架构
```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   Streamlit     │◄──►│    Go Gin API    │◄──►│   PostgreSQL    │
│   前端界面      │    │    后端服务      │    │    主数据库     │
└─────────────────┘    └──────────────────┘    └─────────────────┘
         │                       │                       │
         │              ┌─────────────────┐              │
         └──────────────►│     Redis       │◄─────────────┘
                        │  缓存+消息队列   │
                        └─────────────────┘
```

## 📦 项目结构

```
📁 ai4s/
├── 📁 backend/                 # Go Gin后端
│   ├── 📁 cmd/                # 主程序入口
│   ├── 📁 internal/           # 内部代码
│   │   ├── 📁 api/           # API控制器
│   │   ├── 📁 config/        # 配置管理
│   │   ├── 📁 database/      # 数据库连接
│   │   ├── 📁 middleware/    # 中间件
│   │   ├── 📁 models/        # 数据模型
│   │   ├── 📁 services/      # 业务逻辑
│   │   └── 📁 websocket/     # WebSocket管理
│   ├── 📄 go.mod             # Go模块文件
│   └── 📄 Dockerfile         # 后端容器化
├── 📁 frontend/               # Streamlit前端
│   ├── 📁 components/        # UI组件
│   ├── 📁 config/           # 前端配置
│   ├── 📁 pages/            # 页面组件
│   ├── 📁 services/         # API服务
│   ├── 📁 utils/            # 工具函数
│   └── 📄 main.py           # 前端入口
├── 📄 docker-compose.yml    # 容器编排
├── 📄 architecture_design.md # 架构设计文档
└── 📄 农业物联网平台PRD文档.md # 产品需求文档
```

## 🚀 快速开始

### 环境要求
- Docker & Docker Compose
- Go 1.21+ (开发环境)
- Python 3.9+ (开发环境)

### 一键启动
```bash
# 克隆项目
git clone <repository-url>
cd ai4s

# 启动所有服务
docker-compose up -d

# 查看服务状态
docker-compose ps
```

### 访问地址
- **前端界面**: http://localhost:8501
- **后端API**: http://localhost:8080
- **数据库管理**: http://localhost:5050 (可选)
- **Redis管理**: http://localhost:8081 (可选)

### 演示账号
- **用户名**: `18823870097`
- **密码**: `yaohongming`

## 🎨 核心功能演示

### 1. Fork功能使用流程

#### 创建项目
```python
# 1. 登录系统
# 2. 进入"项目管理"页面
# 3. 点击"新建项目"
# 4. 配置可视化界面
# 5. 保存项目
```

#### Fork项目
```python
# 1. 浏览公开项目
# 2. 找到心仪的项目
# 3. 点击"Fork"按钮
# 4. 自定义项目名称和描述
# 5. 修改配置满足自己需求
# 6. 保存Fork项目
```

#### 协作管理
```python
# 1. 给喜欢的项目点赞
# 2. 查看项目历史变更
# 3. 提交合并请求（高级功能）
# 4. 分享项目给其他用户
```

### 2. 实时数据监控

#### WebSocket连接
```javascript
// 前端自动建立WebSocket连接
// 订阅感兴趣的设备数据
// 实时更新图表和界面
```

#### 数据可视化
- **时间序列图**: 设备历史数据趋势
- **实时仪表盘**: 当前设备状态
- **地理分布图**: 设备位置和状态
- **统计分析图**: 数据统计和对比

### 3. 设备管理

#### 设备接入
```bash
# 设备数据上报API
curl -X POST http://localhost:8080/api/v1/devices/{device_id}/data \
  -H "Content-Type: application/json" \
  -d '{
    "temperature": 25.6,
    "humidity": 68.2,
    "timestamp": "2025-08-14T10:30:00Z"
  }'
```

#### 设备监控
- 设备在线状态实时监控
- 设备数据异常告警
- 设备性能统计分析
- 设备分组管理

## 🔧 开发指南

### 后端开发

#### 添加新设备类型
```go
// 1. 在 models/device.go 中添加设备类型
const NewDeviceType DeviceType = 14

// 2. 更新设备类型名称映射
var DeviceTypeNames = map[DeviceType]string{
    // ...existing types...
    NewDeviceType: "新设备类型",
}

// 3. 更新前端设置
// frontend/config/settings.py
```

#### 添加新API端点
```go
// 1. 在 controllers/ 中创建控制器
// 2. 在 api/routes.go 中注册路由
// 3. 更新API文档
```

### 前端开发

#### 添加新页面
```python
# 1. 在 pages/ 目录创建页面组件
# 2. 在 main.py 中注册页面
# 3. 更新侧边栏导航
```

#### 自定义图表
```python
import plotly.graph_objects as go

def create_custom_chart(data):
    fig = go.Figure()
    # 添加图表配置
    return fig
```

## 📈 性能优化

### 缓存策略
- **API响应缓存**: Redis缓存频繁请求
- **会话状态缓存**: Streamlit session state
- **数据库查询优化**: 索引和查询优化

### 实时性能
- **WebSocket连接池**: 高效的实时通信
- **数据压缩**: 减少网络传输
- **异步处理**: 非阻塞数据处理

### 扩展性设计
- **微服务架构**: 支持服务拆分
- **负载均衡**: 支持水平扩展
- **容器化部署**: 易于部署和维护

## 🔐 安全特性

### 认证授权
- **JWT Token**: 安全的用户认证
- **角色权限**: 基于角色的访问控制
- **会话管理**: 安全的会话处理

### 数据安全
- **SQL注入防护**: 参数化查询
- **XSS防护**: 输入验证和输出编码
- **CSRF防护**: CSRF Token验证

### API安全
- **限流控制**: API访问频率限制
- **CORS配置**: 跨域请求控制
- **HTTPS支持**: 数据传输加密

## 🎯 产品优势

### vs 原Java系统
- **性能提升**: Go并发处理能力强，响应速度快50%+
- **资源占用**: 内存占用降低60%，CPU使用率降低40%
- **开发效率**: Streamlit快速原型，开发效率提升3倍

### vs 传统IoT平台
- **Fork功能**: 独创的项目配置管理模式
- **实时性**: 毫秒级数据推送
- **易用性**: 零代码可视化配置
- **扩展性**: 插件化架构设计

## 🗺️ 未来规划

### Phase 2: 智能分析
- **机器学习**: 设备故障预测
- **异常检测**: 智能数据异常识别
- **优化建议**: AI驱动的优化方案

### Phase 3: 生态扩展
- **开放API**: 第三方系统集成
- **插件市场**: 社区贡献组件
- **云原生**: 多云部署支持

### Phase 4: 企业级功能
- **多租户**: 企业级多租户架构
- **审计日志**: 完整的操作审计
- **高可用**: 99.9%可用性保证

## 🤝 贡献指南

### 贡献方式
1. Fork项目
2. 创建功能分支
3. 提交代码
4. 发起Pull Request

### 代码规范
- **Go**: 遵循Go官方编码规范
- **Python**: 遵循PEP 8规范
- **文档**: 完整的API文档和代码注释

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

## 📞 联系方式

- **开发者**: zhuoying.li
- **项目地址**: [GitHub Repository]
- **文档地址**: [Documentation]

---

**🌱 让农业更智能，让数据更有价值！**